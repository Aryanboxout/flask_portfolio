{% extends "layouts/base.html" %}

{% block body %}
    <body style = " background-color: lightgrey;">
    <font color = "black">
        <h1>Binary Addition</h1>
        <p>First bit changes sign</p>

        <br />

        <div class="row">
            <div class="col-sm-1"></div>
            {% for i in range(1, 9) %}
                <button class="col-sm-1" id="o{{i}}" onclick="toggleSwitch('o{{i}}')">0</button>
            {% endfor %}

            <div class="offset-sm-1 col-sm-2">
                <p id="o">Unsigned Decimal value: 0</p>
            </div>
            <div class="offset-sm-1 col-sm-2">
                <p id="x">Signed Decimal value: 0</p>
            </div>
        </div>

        <br />

        <div class="row">
            <div class="col-sm-1"></div>
            {% for i in range(1, 9) %}
                <button class="col-sm-1" id="t{{i}}" onclick="toggleSwitch('t{{i}}')">0</button>
            {% endfor %}

            <div class="offset-sm-1 col-sm-2">
                <p id="t">Unsigned Decimal value: 0</p>
            </div>
            <div class="offset-sm-1 col-sm-2">
                <p id="y">Signed Decimal value: 0</p>
            </div>
        </div>

        <br />

        <div class="row">
            <div class="col-sm-1"></div>
            <button class="col-sm-1" id="add" onclick="unsignedAddition('add')">Add</button>

            <div class="offset-sm-8 col-sm-2">
                <p id="addOutput">Added Decimal Value: </p>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-1"></div>
            <button class="col-sm-2" id="signedAddition" onclick="signedAddition('signedAddition')">Toggle signed numbers and signed addition</button>

            <div class="offset-sm-7 col-sm-2">
                <p id="signedOutput">Signed Added Decimal value: </p>
            </div>
        </div>



        <script>
            var first = 0;
            var second = 0;

            function unsignedAddition () {
                added = first + second
                var addedStr = added.toString();
                document.getElementById('addOutput').innerHTML = "Added Decimal value: " + addedStr;
            }

            function signedAddition () {
                var sum1 = 0;
                var sum2 = 0;
                var output = 0;
                const firstBitOne = document.getElementById('o1');
                const firstBitTwo = document.getElementById('t1');
                for (var i = 2; i <= 8; i++) {
                    let element1 = document.getElementById('o' + i);
                    sum1 += Math.pow(2, 8 - i) * parseInt(element1.innerHTML);
                }
                for (var i = 2; i <= 8; i++) {
                    let element2 = document.getElementById('t' + i);
                    sum2 += Math.pow(2, 8 - i) * parseInt(element2.innerHTML);
                }
                if (firstBitOne.innerHTML == "1") {
                    sum1 = 0-sum1;
                }
                else {
                    sum1 = sum1;
                }

                document.getElementById('x').innerHTML = "Signed Decimal value: " + sum1;

                if (firstBitTwo.innerHTML == "1") {
                    sum2 = 0-sum2;
                }
                else {
                    sum2 = sum2;
                }

                document.getElementById('y').innerHTML = "Signed Decimal value: " + sum2;

                output = sum1 + sum2
                var outputStr = output.toString();
                document.getElementById('signedOutput').innerHTML = "Unsigned Added Decimal value: " + outputStr;

            }

            function toggleSwitch (id) {
                const element = document.getElementById(id);
                if (element.innerHTML == "1") {
                    element.innerHTML = "0";
                } else {
                    element.innerHTML = "1";
                }
                element.classList.toggle("buttonOn");
                element.classList.toggle("buttonOff");

                calculateRow(id.charAt(0));
            }

            function calculateRow (row) {
                let sum = 0;
                for (var i = 1; i <= 8; i++) {
                    let element = document.getElementById(row + i);
                    sum += Math.pow(2, 8 - i) * parseInt(element.innerHTML);
                }
                document.getElementById(row).innerHTML = "Unsigned Decimal value: " + sum;
                switch (row) {
                    case 'o':
                        first = sum;
                        break;
                    case 't':
                        second = sum;
                        break;
                    default:
                        break;
                }

            }



            function reset () {
                for (var i = 1; i <= 8; i++) {
                    document.getElementById('o' + i).innerHTML = "0";
                    document.getElementById('t' + i).innerHTML = "0";


                    calculateRow('o');
                    calculateRow('t');

                    document.getElementById('o' + i).classList.add("buttonOff");
                    document.getElementById('t' + i).classList.add("buttonOff");

                    document.getElementById('o' + i).classList.remove("buttonOn");
                    document.getElementById('t' + i).classList.remove("buttonOn");

                }
            }

            window.onload = reset();

        </script>

        <style>

            .buttonOff {
                background-color: black;
                color: white;
                font-style: normal;
            }

            .buttonOn {
                background-color: blue;
                color: black;
                font-style: italic;
            }

        </style>

{% endblock %}